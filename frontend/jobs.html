<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Job Results</title>
</head>
<body style="font-family: Arial, sans-serif; text-align: center; padding: 20px;">

    <h2 style="color: #333;">üìã Job Listings</h2>
    <div id="jobResults" style="text-align: left; display: inline-block; width: 80%;"></div>

    <script>
        document.addEventListener("DOMContentLoaded", async function() {
            let params = new URLSearchParams(window.location.search);
            let jobTitles = JSON.parse(decodeURIComponent(params.get("jobs")));
            let experience = params.get("exp");
            let location = params.get("loc");

            document.getElementById("jobResults").innerHTML = `<p>Searching for jobs matching: <strong>${jobTitles.join(", ")}</strong> with <strong>${experience} years</strong> of experience in <strong>${location}</strong></p>`;

            // Replace with your actual backend API URL
            let apiUrl = `http://localhost:5000/api/jobs?titles=${encodeURIComponent(JSON.stringify(jobTitles))}&experience=${experience}&location=${location}`;

            try {
                let response = await fetch(apiUrl);
                let jobs = await response.json();

                if (jobs.length === 0) {
                    document.getElementById("jobResults").innerHTML += `<p style="color: red;">‚ùå No jobs found!</p>`;
                } else {
                    let jobListHTML = jobs.map(job => `
                        <div style="background: #f9f9f9; padding: 10px; margin: 10px 0; border-radius: 5px; box-shadow: 0px 0px 5px #ddd;">
                            <h3 style="margin: 0;">${job.title}</h3>
                            <p><strong>Company:</strong> ${job.company}</p>
                            <p><strong>Location:</strong> ${job.location}</p>
                            <p><strong>Experience Required:</strong> ${job.experience}</p>
                            <a href="${job.link}" target="_blank" style="color: #007bff; text-decoration: none;">üîó Apply Here</a>
                        </div>
                    `).join('');

                    document.getElementById("jobResults").innerHTML += jobListHTML;
                }
            } catch (error) {
                console.error("Error fetching jobs:", error);
                document.getElementById("jobResults").innerHTML += `<p style="color: red;">‚ùå Failed to fetch jobs!</p>`;
            }
        });
    </script>

</body>
</html>
